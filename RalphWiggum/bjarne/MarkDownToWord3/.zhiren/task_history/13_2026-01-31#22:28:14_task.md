TASK: [from TASKS.md line 67] Implement table support in PDF â†’ Tables render with borders in PDF

ACTION: Modify PDFGenerator.processTable() method to render Markdown tables (GFM format) with borders, proper cell sizing, header row formatting, and cell content rendering using PDFBox APIs.

EXPECTED_OUTCOME:
- Tables render with visible borders (grid lines)
- Header row (first row) has bold text formatting
- Cell content displays with proper text wrapping
- Column widths adjust to fit content
- PDF compiles successfully with mvn clean compile
- Manual test: Markdown with tables produces PDF with visible table formatting

EXISTING_CODE:
- PDFGenerator.java (lines 825-836): processTable() is a placeholder (just returns yPosition)
- processTable signature: takes TableBlock, PDDocument, PDPageContentStream, yPosition
- Marked "TO BE IMPLEMENTED in subsequent task"

- WordGenerator table implementation (lines 421-495):
  - processTable(TableBlock, XWPFDocument)
  - Collects TableRow nodes from TableHead and TableBody (skips TableSeparator)
  - Two-pass approach: First counts rows/columns, then processes cells
  - First row gets bold formatting (header row)
  - Processes cell content using processInlineContent() for formatting
  - Handles TableCell nodes with inline content (Text, StrongEmphasis, Emphasis, etc.)

- Table node structure (flexmark tables extension):
  - TableBlock: Root table node
    - TableHead: Contains header rows (optional)
    - TableBody: Contains body rows (optional)
    - TableSeparator: Separator between header and body (skipped)
    - TableRow: Contains TableCell children
      - TableCell: Contains inline content (Text, StrongEmphasis, Emphasis, Code, Link, etc.)

- PDFBox drawing capabilities (from code blocks and blockquotes):
  - content.setNonStrokingColor(r, g, b) - sets fill color
  - content.setStrokingColor(r, g, b) - sets stroke/border color
  - content.addRect(x, y, width, height) - defines rectangle path
  - content.moveTo(x, y) - moves to point
  - content.lineTo(x, y) - draws line to point
  - content.stroke() - strokes path
  - content.fill() - fills path
  - endText(), beginText() - switch between text and graphics modes

PATTERNS:
- Two-pass rendering: First pass calculates dimensions, second pass renders
- Border drawing: Draw grid lines using moveTo(), lineTo(), stroke()
- Cell positioning: Calculate X, Y positions for each cell manually
- Header formatting: First row (rowIndex == 0) gets bold font
- Y position management: Return after processing all rows
- Text positioning: Use processInlineContent() with specific X, Y coordinates

PLAN:
1. Add constants for table styling:
   - private static final float TABLE_CELL_PADDING = 5; // Padding within cells
   - private static final float TABLE_BORDER_WIDTH = 1; // Border line width
   - private static final float TABLE_ROW_HEIGHT = 20; // Minimum row height
   - private static final float TABLE_MIN_COLUMN_WIDTH = 50; // Minimum column width

2. First pass: Collect and analyze table structure:
   - Collect all TableRow nodes from TableHead and TableBody
   - Skip TableSeparator nodes
   - Count total rows and determine maximum columns
   - For each cell, extract text and calculate width using calculateTextWidth()
   - Track maximum width for each column
   - Calculate total table width: sum of all column widths + (columnCount + 1) * padding

3. Calculate table dimensions:
   - tableWidth = sum(maxColumnWidths) + (columnCount + 1) * TABLE_CELL_PADDING
   - tableHeight = rowCount * TABLE_ROW_HEIGHT
   - tableX = MARGIN
   - tableY = yPosition - tableHeight

4. Second pass: Render table with borders:
   - Save text state: content.endText()
   - Set border color: content.setStrokingColor(0f, 0f, 0f) // Black borders
   - Set border width: content.setLineWidth(TABLE_BORDER_WIDTH)

5. Draw table borders (grid):
   - Draw outer rectangle: addRect(tableX, tableY, tableWidth, tableHeight), stroke()
   - For each row: draw horizontal lines
   - For each column: draw vertical lines
   - Or: Draw complete grid by iterating all cell boundaries

6. Restore text state and render cell content:
   - content.beginText()
   - Load fonts (regular, bold, italic, bold-italic)
   - For each row (rowIndex from 0 to rowCount-1):
     * For each cell in row:
       - Calculate cell X position: tableX + sum(previousColumnWidths) + TABLE_CELL_PADDING
       - Calculate cell Y position: tableY + ((rowCount - rowIndex - 1) * TABLE_ROW_HEIGHT) - TABLE_CELL_PADDING
       - Set font: boldFont for header row (rowIndex == 0), regularFont for others
       - Process cell content: processInlineContent(cell, document, page, content, cellX, cellY, ...)
       - Move to next cell position

7. Process cell content:
   - TableCell nodes contain inline content directly (no wrapper Paragraph)
   - Iterate through cell.getChildren() for Text, StrongEmphasis, Emphasis, Code, Link nodes
   - Use processInlineContentWithX() to render with formatting and track X position
   - Handle empty cells (no children)

8. Update Y position:
   - yPosition = tableY - spacing below table
   - Return yPosition

9. Handle edge cases:
   - Empty tables (0 rows or 0 columns) - return early
   - Tables with missing cells (irregular rows)
   - Very long cell content (will overflow, same limitation as paragraphs)
   - Tables spanning multiple pages (not implemented, single page only)

10. Update class javadoc:
    - Change "Tables - TO BE IMPLEMENTED" to "Tables with borders and header formatting"

11. Update generate() method:
    - Remove "TO BE IMPLEMENTED in subsequent task" comment
    - Add page parameter if needed for link annotations in cells

FILES_TO_CREATE:
- None

FILES_TO_MODIFY:
- MarkDownToWordSource/src/main/java/com/md2word/generator/PDFGenerator.java

TEST_COMMAND:
mvn clean compile

OUTCOME_VERIFICATION:
- processTable() implemented: grep "Draw table grid\|TABLE_CELL_PADDING\|TABLE_BORDER_WIDTH" PDFGenerator.java
- Border drawing: grep "stroke.*table\|addRect.*table\|moveTo.*table" PDFGenerator.java
- Header row bold: Check if rowIndex == 0 uses boldFont
- Compiles successfully: mvn clean compile exit code 0
- Manual test: Create test-tables.md with GFM table, convert to PDF, verify borders, header formatting

TECHNICAL NOTES:
- PDFBox coordinate system: (0,0) is bottom-left, Y increases upward
- Table structure: Two-pass approach essential (calculate first, then render)
- Cell positioning: Manual X, Y calculation for each cell
- Border drawing: Draw grid lines using moveTo, lineTo, stroke
- Grid approach: Draw horizontal and vertical lines for complete table grid
- Column width tracking: Maintain array of maxColumnWidths[columnIndex]
- Row height: Fixed height (TABLE_ROW_HEIGHT) for simplicity
- Cell padding: TABLE_CELL_PADDING on all sides
- Header row: First row (rowIndex == 0) gets bold font
- Cell content: Direct inline nodes, no wrapper Paragraph
- Y position calculation: tableY = yPosition - (rowCount * TABLE_ROW_HEIGHT)
- Multi-page tables: Not supported (same limitation as other elements)
- Text wrapping: Not implemented (same limitation as paragraphs)
- Border color: Black (0, 0, 0) for table grid
- Border width: 1 point for visible but not overpowering lines
