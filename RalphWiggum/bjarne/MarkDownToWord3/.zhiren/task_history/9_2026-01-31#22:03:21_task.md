TASK: [from TASKS.md line 63] Implement hyperlink support in PDF â†’ Links are clickable in PDF document

ACTION: Modify PDFGenerator.processInlineContent() to create clickable hyperlinks for Link nodes using PDFBox's PDAnnotationLink and PDActionURI. Replace the current placeholder that just shows link text.

EXPECTED_OUTCOME:
- Links [text](url) render as clickable blue underlined text in PDF
- Clicking link opens URL in default browser
- Link text inherits formatting (bold, italic) correctly
- Link URLs are properly encoded/escaped
- PDF compiles successfully with mvn clean compile
- Manual test: Markdown with links produces PDF with clickable hyperlinks

EXISTING_CODE:
- PDFGenerator.java (lines ~262-270): Link node handling currently just recurses to show text
- Comment says "Full hyperlink support (clickable links) will be added in a subsequent task"
- Link node from flexmark: com.vladsch.flexmark.ast.Link
- Link methods: link.getUrl() returns CharSequence for the URL
- Link children: Contains Text nodes with link text content

- PDFBox hyperlink API:
  - PDAnnotationLink: Annotation class for links
  - PDActionURI: Action to open a URI
  - PDRectangle: Defines the clickable area bounds
  - PDDocument.getDocumentCatalog().getAcroForm() or page.getAnnotations()
  - Coordinates: PDF uses bottom-left origin, need to calculate text bounds

- WordGenerator link handling (lines ~254-276): Reference implementation
  - Extracts link text from children
  - Creates hyperlink run with blue color and underline
  - Sets run.setColor("0000FF") and run.setUnderline(UnderlinePatterns.SINGLE)

PATTERNS:
- PDFBox link creation pattern:
  1. Draw link text with setFont() and showText()
  2. Track text position (x, y) and dimensions (width, height)
  3. Create PDRectangle for link bounds
  4. Create PDActionURI with URL
  5. Create PDAnnotationLink with action and rectangle
  6. Add annotation to page: page.getAnnotations().add(linkAnnotation)

- Text measurement: Need to calculate text width for link bounds
  - PDFont.getFontDescriptor().getCapHeight() * fontSize for height
  - PDFont.getStringWidth(text) * fontSize / 1000 for width
  - Y position: current Y - fontSize (text baseline)

- Pattern from processInlineContent: Track (x, y) position through recursive calls
- Link styling: Blue color, underline (optional for PDF links)

PLAN:
1. Read PDFGenerator.java completely to understand current structure

2. Modify processInlineContent() signature to track X position:
   - Add float xPosition parameter to track horizontal position
   - Update all recursive calls to pass xPosition
   - Return both X and Y positions? Or use instance variable?
   - Alternative: Return float[] {x, y} or create Position class
   - Simpler: Keep X as parameter, track as we go (increment by text width)

3. Calculate text width helper method:
   - private float calculateTextWidth(String text, PDFont font, float fontSize)
   - Uses: font.getStringWidth(text) * fontSize / 1000
   - Returns width in PDF points

4. Modify processInlineContent() to handle Link nodes:
   - if (child instanceof Link):
     * Extract link URL: String url = link.getUrl().toString()
     * Extract link text: process children to get text string
     * Calculate link text position (current x, y)
     * Draw link text with blue color
     * Measure text width
     * Create PDRectangle for link bounds (x, y - fontSize, width, fontSize)
     * Create PDActionURI with url
     * Create PDAnnotationLink with action and rectangle
     * Add annotation to page: page.getAnnotations().add(linkAnnotation)
     * Update xPosition by text width

5. Link styling (optional):
   - Set text color to blue: PDFont doesn't support color directly
   - Need PDPageContentStream.setNonStrokingColor() for text color
   - For now: Skip color (keep black text), just make clickable
   - Or: Use setNonStrokingColor(0f, 0f, 1f) for blue, then restore to black

6. Update method signatures:
   - processInlineContent() now needs xPosition parameter
   - processHeading() and processParagraph() track X position
   - Start X at MARGIN, increment as text is added

7. PDFBox API for links:
   - PDAnnotationLink linkAnnot = new PDAnnotationLink()
   - linkAnnot.setAction(PDActionURI.createURI(url))
   - linkAnnot.setRectangle(PDRectangle)
   - page.getAnnotations().add(linkAnnot)

8. Y position for link bounds:
   - Text baseline is at current Y
   - PDF rectangles use bottom-left corner
   - Link bounds: (x, y - fontSize, width, fontSize)
   - Need to account for font descent

9. Word wrapping consideration:
   - Links might wrap across lines (complex)
   - For now: Assume links don't wrap (same limitation as general text)
   - Document in comments

10. Color handling:
    - PDPageContentStream.setNonStrokingColor(r, g, b) for text fill color
    - Blue: setNonStrokingColor(0, 0, 1) or Color.BLUE.density()
    - After link, restore to black: setNonStrokingColor(0, 0, 0)
    - Need to wrap setNonStrokingColor around beginText/endText blocks
    - Actually: Can change color mid-text-block, just call setNonStrokingColor before showText

11. Testing approach:
    - Create test Markdown with: [GitHub](https://github.com)
    - Convert to PDF
    - Open PDF, verify link is clickable and blue
    - Test link in heading: # [Link in Heading](url)
    - Test link with formatting: **[Bold Link](url)**

FILES_TO_CREATE:
- None

FILES_TO_MODIFY:
- MarkDownToWordSource/src/main/java/com/md2word/generator/PDFGenerator.java

TEST_COMMAND:
mvn clean compile

OUTCOME_VERIFICATION:
- PDFGenerator handles Link nodes: grep "PDAnnotationLink\|PDActionURI" PDFGenerator.java
- Creates clickable links: grep "page.getAnnotations().add" PDFGenerator.java
- Compiles successfully: mvn clean compile exit code 0
- Manual test: Create test.md with [link](url), convert to PDF, verify clickable

TECHNICAL NOTES:
- PDFBox link annotations require PDRectangle with exact bounds
- Text measurement: font.getStringWidth(text) * fontSize / 1000 gives width in points
- PDF coordinates: (0,0) is bottom-left, Y increases upward
- Link bounds: (x, y-fontSize, width, fontSize*1.2) to include some padding
- Color changes: setNonStrokingColor(r, g, b) before showText(), restore after
- Page annotations: page.getAnnotations() returns List<PDAnnotation>
- URL encoding: PDFActionURI.createURI() handles encoding automatically
- X position tracking: Start at MARGIN, increment by text width after each showText()
- Multiple links on same line: Track X position across processInlineContent() calls
- Link text may contain formatting: Need to process inline content within link
- Complex case: **[Bold link](url)** should be bold, blue, and clickable
